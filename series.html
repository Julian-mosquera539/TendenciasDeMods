<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Series Interactivas</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Series Interactivas</h1>
        <button id="dark-mode-toggle">Modo Oscuro</button>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Películas</a></li>
            <li><a href="series.html">Series</a></li>
            <li><a href="descargas.html">Descargas</a></li>
        </ul>
    </nav>

    <!-- Sección de búsqueda -->
    <div id="search-bar">
        <input type="text" id="search-input" placeholder="Buscar series...">
        <button onclick="searchSeries()">Buscar</button>
    </div>

    <!-- Resultados de búsqueda -->
    <div id="search-results"></div>

    <!-- Contenido principal -->
    <section id="content">
        <h2>Series Populares</h2>
    </section>

    <!-- Modal de detalles -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">X</button>
            <img id="modal-poster" alt="Poster">
            <h2 id="modal-title">Título</h2>
            <p id="modal-overview">Descripción</p>
            <p><strong>Reparto:</strong> <span id="modal-cast">Cargando...</span></p>
        </div>
    </div>

    <script>
        const API_URL = "https://api.themoviedb.org/3";
        const API_KEY = "9e9698108533009ffe2584455b931f5a";

        const contentDiv = document.getElementById('content');
        const searchResults = document.getElementById('search-results');
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalOverview = document.getElementById('modal-overview');
        const modalPoster = document.getElementById('modal-poster');

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        document.getElementById('dark-mode-toggle').addEventListener('click', toggleDarkMode);

        async function fetchSeries(endpoint) {
            const response = await fetch(`${API_URL}${endpoint}?api_key=${API_KEY}&language=es`);
            const data = await response.json();
            return data.results;
        }

        async function loadPopularSeries() {
            const series = await fetchSeries('/tv/popular');
            series.forEach(renderCard);
        }

        async function searchSeries() {
            const query = document.getElementById('search-input').value;
            const series = await fetchSeries(`/search/tv?query=${query}`);
            searchResults.innerHTML = '';
            series.forEach(renderCard);
        }

        function renderCard(serie) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.innerHTML = `
                <img src="https://image.tmdb.org/t/p/w500${serie.poster_path}" alt="${serie.name}">
                <h4>${serie.name}</h4>
            `;
            card.addEventListener('click', () => showModal(serie.id));
            contentDiv.appendChild(card);
        }

        async function showModal(id) {
            const serie = await fetch(`${API_URL}/tv/${id}?api_key=${API_KEY}&language=es`).then(res => res.json());
            modalTitle.textContent = serie.name;
            modalOverview.textContent = serie.overview;
            modalPoster.src = `https://image.tmdb.org/t/p/w500${serie.poster_path}`;
            modal.style.display = 'flex';
        }

        function closeModal() {
            modal.style.display = 'none';
        }

        loadPopularSeries();
    </script>
</body>
</html>
