<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Series</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Series</h1>
        <button id="dark-mode-toggle">Modo Oscuro</button>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Películas</a></li>
            <li><a href="series.html">Series</a></li>
            <li><a href="descargas.html">Descargas</a></li>
        </ul>
    </nav>

    <!-- Categorías -->
    <section id="categories">
        <h2>Series Populares</h2>
        <div id="series-list"></div>
    </section>

    <!-- Géneros -->
    <section id="genres">
        <h2>Categorías por Género</h2>
        <div id="genres-list"></div>
    </section>

    <script>
        const API_URL = "https://api.themoviedb.org/3";
        const API_KEY = "9e9698108533009ffe2584455b931f5a";

        const seriesList = document.getElementById('series-list');
        const genresList = document.getElementById('genres-list');

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }

        document.getElementById('dark-mode-toggle').addEventListener('click', toggleDarkMode);

        async function fetchContent(endpoint) {
            const response = await fetch(`${API_URL}${endpoint}?api_key=${API_KEY}&language=es`);
            const data = await response.json();
            return data.results;
        }

        async function loadSeries() {
            const series = await fetchContent('/tv/popular');
            series.forEach(serie => renderCard(serie, seriesList));
        }

        async function loadGenres() {
            const genres = await fetch(`${API_URL}/genre/tv/list?api_key=${API_KEY}&language=es`).then(res => res.json());
            genres.genres.forEach(genre => {
                const genreDiv = document.createElement('div');
                genreDiv.classList.add('genre');
                genreDiv.innerHTML = `<h4>${genre.name}</h4>`;
                genreDiv.addEventListener('click', () => filterByGenre(genre.id));
                genresList.appendChild(genreDiv);
            });
        }

        async function filterByGenre(genreId) {
            const series = await fetch(`${API_URL}/discover/tv?api_key=${API_KEY}&with_genres=${genreId}&language=es`).then(res => res.json());
            seriesList.innerHTML = ''; // Limpia contenido actual
            series.results.forEach(serie => renderCard(serie, seriesList));
        }

        function renderCard(item, container) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.innerHTML = `
                <img src="https://image.tmdb.org/t/p/w500${item.poster_path}" alt="${item.name}">
                <h4>${item.name}</h4>
            `;
            container.appendChild(card);
        }

        loadSeries();
        loadGenres();
    </script>
</body>
</html>
